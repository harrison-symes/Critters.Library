;/*FB_PKG_DELIM*/

__d("CometSuperPollVoterDialogQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="24219996027626479"}),null);
__d("LSHandleMessageRestoreResponse",["LSArrayGetObjectAt","LSDecryptMessages","LSDeleteBackupOnClient","LSIsEncryptionVersionSecure","LSIssueNewTask","LSIssuePointQueryRestoreTask","LSLoadThreadPkFromThreadId","LSLogMebClientEvent.nop","LSLogWebQpl.nop","LSRestoreEchoBlobs.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][handleMessageRestoreResponse] Beginning execution."),d[1]=c.i64.of_float(Date.now()),a[7]?(d[11]="handleMessageRestoreResponse was called with instructions to delete the user's EB client state",function(a){c.logger(a).info(a)}(["[EncryptedBackups][handleMessageRestoreResponse] ","",d[11]].join("")),d[12]=c.createArray(),void 0!==void 0?d[13]=(d[12].push(void 0),d[12]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"handleMessageRestoreResponse",[d[11]].join(""),d[12],c.i64.cast([0,4]))):c.resolve()},function(e){return d[2]=a[5].get("request_id"),d[3]=c.i64.of_int32(a[0].length),d[2]!==void 0?c.nativeOperation(b("LSLogWebQpl.nop"),d[2],c.i64.cast([0,521476165]),"call_from_client",d[3],void 0,void 0):c.resolve()},function(e){return c.i64.neq(a[6],void 0)?c.sequence([function(a){return c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[17]=new c.Map(),d[17].set("error_msg","Expected a nonempty query result"),d[17].set("code",c.i64.cast([0,3])),d[17].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),d[18]=c.createArray(),d[19]=(d[18].push(d[17]),d[18]),e=[void 0,d[18]],d[11]=e[0],d[12]=e[1]):(b=a.item,d[17]=new c.Map(),d[17].set("backup_id",b.backupId),d[17].set("device_public_key_blob",b.devicePublicKeyBlob),d[17].set("device_private_key_blob",b.devicePrivateKeyBlob),d[17].set("epoch_storage_public_key_blob",b.epochStoragePublicKeyBlob),d[17].set("epoch_storage_private_key_blob",b.epochStoragePrivateKeyBlob),d[17].set("epoch_auth_public_key_blob",b.epochAuthPublicKeyBlob),d[17].set("epoch_auth_private_key_blob",b.epochAuthPrivateKeyBlob),d[17].set("mailbox_root_key_blob",b.mailboxRootKeyBlob),d[17].set("ocmf_client_state_blob",b.ocmfClientStateBlob),d[17].set("orf_client_state_v2_blob",void 0),d[17].set("orf_v2_authority_level",void 0),d[17].set("oblivious_validation_token_blob",b.obliviousValidationTokenBlob),d[17].set("device_id",b.deviceId),d[17].set("backup_tenancy",b.backupTenancy),d[17].set("encryption_version",b.encryptionVersion),d[17].set("revision_version",b.revisionVersion),d[17].set("initialize_restore_result",void 0),d[17].set("device_creation_timestamp_sec",void 0),d[17].set("authority_level",b.authorityLevel),e=[d[17],void 0],d[11]=e[0],d[12]=e[1])})},function(e){return d[14]=new c.Map(),d[14].set("value",d[11]),d[14].set("errors",d[12]),d[15]=d[14].get("value"),d[15]!==void 0?c.sequence([function(e){return d[17]=d[15].get("backup_id"),d[18]=d[15].get("device_public_key_blob"),d[19]=d[15].get("device_private_key_blob"),d[20]=d[15].get("epoch_storage_public_key_blob"),d[21]=d[15].get("epoch_storage_private_key_blob"),d[22]=d[15].get("epoch_auth_public_key_blob"),d[23]=d[15].get("epoch_auth_private_key_blob"),d[24]=d[15].get("mailbox_root_key_blob"),d[25]=d[15].get("ocmf_client_state_blob"),d[26]=d[15].get("orf_client_state_v2_blob"),d[27]=d[15].get("orf_v2_authority_level"),d[28]=d[15].get("oblivious_validation_token_blob"),d[29]=d[15].get("device_id"),d[30]=d[15].get("backup_tenancy"),d[31]=d[15].get("encryption_version"),d[32]=d[15].get("revision_version"),d[33]=d[15].get("initialize_restore_result"),d[34]=d[15].get("device_creation_timestamp_sec"),d[35]=d[15].get("authority_level"),c.i64.neq(d[29],void 0)?c.sequence([function(a){return d[37]=void 0,c.i64.neq(d[37],void 0)?c.resolve(d[38]=d[37]):c.sequence([function(a){return d[41]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[42]=a[0],a})},function(a){return d[42]?d[51]=(d[41].push(c.i64.cast([0,0])),d[41]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[43]?d[51]=(d[41].push(c.i64.cast([0,2])),d[41]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[44]=a[0],a})},function(a){return d[44]?d[51]=(d[41].push(c.i64.cast([0,3])),d[41]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[45]=a[0],a})},function(a){return d[45]?d[51]=(d[41].push(c.i64.cast([0,4])),d[41]):0,d[46]=c.createArray(),d[47]=c.i64.of_int32(d[41].length),c.i64.gt(d[47],c.i64.cast([0,0]))?c.loopAsync(d[47],function(a){return d[51]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[41],d[51]).then(function(a){return a=a,d[52]=a[0],d[53]=a[1],a})},function(a){return d[54]=(d[46].push(d[52]),d[46])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[51]=c.createArray(),d[52]=c.i64.of_int32(d[46].length),c.i64.gt(d[52],c.i64.cast([0,0]))?c.loopAsync(d[52],function(a){return d[54]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[46],d[54]).then(function(a){return a=a,d[55]=a[0],d[56]=a[1],a})},function(a){return d[57]=(d[51].push(c.i64.to_string(d[55])),d[51])}])}):c.resolve()},function(a){return d[53]=d[51].join(","),d[48]=d[53]}])},function(a){return d[46].some(function(a){return c.i64.eq(d[31],a)})?d[49]=d[31]:d[49]=void 0,c.i64.neq(d[49],void 0)?d[50]=d[49]:d[50]=void 0,d[38]=d[50]}])},function(b){return c.i64.neq(d[38],void 0)?d[39]=d[38]:d[39]=c.i64.cast([0,0]),c.i64.neq(d[30],void 0)?d[40]=d[30]:d[40]=c.i64.cast([0,1]),d[36]=c.i64.neq(d[29],a[6])}]):c.resolve(d[36]=!1)},function(a){return d[16]=d[36]}]):c.resolve((d[17]=d[14].get("errors"),d[18]=d[14].get("errors"),d[16]=!1))},function(a){return d[4]=d[16]}]):c.resolve(d[4]=!1)},function(e){return d[4]?c.sequence([function(a){return d[11]="Exiting early due to EBDevice ID mismatch",function(a){c.logger(a).info(a)}(["[EncryptedBackups][handleMessageRestoreResponse] ","",d[11]].join("")),d[12]=c.createArray(),void 0!==void 0?d[16]=(d[12].push(void 0),d[12]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"handleMessageRestoreResponse",[d[11]].join(""),d[12],c.i64.cast([0,4]))},function(e){return d[13]=new c.Map(),d[13].set("error_code",c.i64.cast([0,110])),d[13].set("stored_procedure","LSEncryptedBackupsHandleMessageRestoreResponseStoredProcedure"),d[13].set("error_message",""),c.storedProcedure(b("LSLoadThreadPkFromThreadId"),a[2]).then(function(a){return a=a,d[14]=a[0],d[15]=a[1],a})}]):c.sequence([function(e){return d[11]=a[5].get("reference_timestamp"),d[12]=a[5].get("request_id"),d[13]=a[5].get("restore_task_source"),c.i64.neq(a[6],void 0)?c.sequence([function(a){return c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[26]=new c.Map(),d[26].set("error_msg","Expected a nonempty query result"),d[26].set("code",c.i64.cast([0,3])),d[26].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),d[27]=c.createArray(),d[28]=(d[27].push(d[26]),d[27]),e=[void 0,d[27]],d[20]=e[0],d[21]=e[1]):(b=a.item,d[26]=new c.Map(),d[26].set("backup_id",b.backupId),d[26].set("device_public_key_blob",b.devicePublicKeyBlob),d[26].set("device_private_key_blob",b.devicePrivateKeyBlob),d[26].set("epoch_storage_public_key_blob",b.epochStoragePublicKeyBlob),d[26].set("epoch_storage_private_key_blob",b.epochStoragePrivateKeyBlob),d[26].set("epoch_auth_public_key_blob",b.epochAuthPublicKeyBlob),d[26].set("epoch_auth_private_key_blob",b.epochAuthPrivateKeyBlob),d[26].set("mailbox_root_key_blob",b.mailboxRootKeyBlob),d[26].set("ocmf_client_state_blob",b.ocmfClientStateBlob),d[26].set("orf_client_state_v2_blob",void 0),d[26].set("orf_v2_authority_level",void 0),d[26].set("oblivious_validation_token_blob",b.obliviousValidationTokenBlob),d[26].set("device_id",b.deviceId),d[26].set("backup_tenancy",b.backupTenancy),d[26].set("encryption_version",b.encryptionVersion),d[26].set("revision_version",b.revisionVersion),d[26].set("initialize_restore_result",void 0),d[26].set("device_creation_timestamp_sec",void 0),d[26].set("authority_level",b.authorityLevel),e=[d[26],void 0],d[20]=e[0],d[21]=e[1])})},function(e){return d[23]=new c.Map(),d[23].set("value",d[20]),d[23].set("errors",d[21]),d[24]=d[23].get("value"),d[24]!==void 0?c.sequence([function(e){return d[26]=d[24].get("backup_id"),d[27]=d[24].get("device_public_key_blob"),d[28]=d[24].get("device_private_key_blob"),d[29]=d[24].get("epoch_storage_public_key_blob"),d[30]=d[24].get("epoch_storage_private_key_blob"),d[31]=d[24].get("epoch_auth_public_key_blob"),d[32]=d[24].get("epoch_auth_private_key_blob"),d[33]=d[24].get("mailbox_root_key_blob"),d[34]=d[24].get("ocmf_client_state_blob"),d[35]=d[24].get("orf_client_state_v2_blob"),d[36]=d[24].get("orf_v2_authority_level"),d[37]=d[24].get("oblivious_validation_token_blob"),d[38]=d[24].get("device_id"),d[39]=d[24].get("backup_tenancy"),d[40]=d[24].get("encryption_version"),d[41]=d[24].get("revision_version"),d[42]=d[24].get("initialize_restore_result"),d[43]=d[24].get("device_creation_timestamp_sec"),d[44]=d[24].get("authority_level"),c.i64.neq(d[38],void 0)?c.sequence([function(a){return d[46]=void 0,c.i64.neq(d[46],void 0)?c.resolve(d[47]=d[46]):c.sequence([function(a){return d[50]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[51]=a[0],a})},function(a){return d[51]?d[60]=(d[50].push(c.i64.cast([0,0])),d[50]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[52]=a[0],a})},function(a){return d[52]?d[60]=(d[50].push(c.i64.cast([0,2])),d[50]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[53]=a[0],a})},function(a){return d[53]?d[60]=(d[50].push(c.i64.cast([0,3])),d[50]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[54]=a[0],a})},function(a){return d[54]?d[60]=(d[50].push(c.i64.cast([0,4])),d[50]):0,d[55]=c.createArray(),d[56]=c.i64.of_int32(d[50].length),c.i64.gt(d[56],c.i64.cast([0,0]))?c.loopAsync(d[56],function(a){return d[60]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[50],d[60]).then(function(a){return a=a,d[61]=a[0],d[62]=a[1],a})},function(a){return d[63]=(d[55].push(d[61]),d[55])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[60]=c.createArray(),d[61]=c.i64.of_int32(d[55].length),c.i64.gt(d[61],c.i64.cast([0,0]))?c.loopAsync(d[61],function(a){return d[63]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[55],d[63]).then(function(a){return a=a,d[64]=a[0],d[65]=a[1],a})},function(a){return d[66]=(d[60].push(c.i64.to_string(d[64])),d[60])}])}):c.resolve()},function(a){return d[62]=d[60].join(","),d[57]=d[62]}])},function(a){return d[55].some(function(a){return c.i64.eq(d[40],a)})?d[58]=d[40]:d[58]=void 0,c.i64.neq(d[58],void 0)?d[59]=d[58]:d[59]=void 0,d[47]=d[59]}])},function(b){return c.i64.neq(d[47],void 0)?d[48]=d[47]:d[48]=c.i64.cast([0,0]),c.i64.neq(d[39],void 0)?d[49]=d[39]:d[49]=c.i64.cast([0,1]),d[45]=c.i64.neq(d[38],a[6])}]):c.resolve(d[45]=!1)},function(a){return d[25]=d[45]}]):c.resolve((d[26]=d[23].get("errors"),d[27]=d[23].get("errors"),d[25]=!1))},function(a){return d[14]=d[25]}]):c.resolve(d[14]=!1)},function(e){return d[14]?c.resolve((d[20]=new c.Map(),d[20].set("error_code",c.i64.cast([0,110])),d[20].set("stored_procedure","LSEncryptedBackupsHandleMessageRestoreResponseStoredProcedure"),d[20].set("error_message",""),d[15]=d[20])):c.sequence([function(e){return d[20]=c.i64.of_int32(a[0].length),d[12]!==void 0?c.nativeOperation(b("LSLogWebQpl.nop"),d[12],c.i64.cast([0,521476165]),"decryption_start",d[20],d[13],void 0):c.resolve()},function(e){return c.storedProcedure(b("LSDecryptMessages"),a[0],a[2]).then(function(a){return a=a,d[21]=a[0],d[22]=a[1],a})},function(e){return d[21]!==void 0?c.sequence([function(e){return c.storedProcedure(b("LSLoadThreadPkFromThreadId"),a[2]).then(function(a){return a=a,d[24]=a[0],d[25]=a[1],a})},function(e){return c.i64.neq(d[24],void 0)?c.sequence([function(e){return d[27]=c.i64.of_int32(a[0].length),d[12]!==void 0?c.nativeOperation(b("LSLogWebQpl.nop"),d[12],c.i64.cast([0,521476165]),"decryption_success",d[27],d[13],void 0):c.resolve()},function(e){return void 0!==void 0?c.resolve(d[28]=void 0):c.sequence([function(a){return d[29]=c.createArray(),d[30]=c.i64.of_int32(d[21].length),c.i64.gt(d[30],c.i64.cast([0,0]))?c.loopAsync(d[30],function(a){return d[39]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[21],d[39]).then(function(a){return a=a,d[40]=a[0],d[41]=a[1],a})},function(a){return d[42]=d[40].get("value"),d[43]=(d[29].push(d[42]),d[29])}])}):c.resolve()},function(e){return d[31]=a[1].get("has_more_before"),d[32]=a[1].get("next_message_timestamp_ms_before"),d[33]=a[1].get("has_more_after"),d[34]=a[1].get("next_message_timestamp_ms_after"),c.nativeOperation(b("LSRestoreEchoBlobs.nop"),d[24],d[29],d[31],d[32],d[33],d[34],a[4],a[2],d[12],d[11],d[13],void 0).then(function(a){return a=a,d[35]=a[0],d[36]=a[1],d[37]=a[2],a})},function(e){return a[7]?c.storedProcedure(b("LSDeleteBackupOnClient"),void 0,void 0,!0,d[12],void 0,!0):c.resolve()},function(e){return d[35]?c.sequence([function(e){return d[39]=c.i64.of_int32(d[37].length),d[40]=c.i64.of_int32(d[36].length),c.i64.eq(d[40],d[39])?c.sequence([function(e){return d[42]=c.i64.cast([0,0]),d[43]=c.i64.of_int32(d[37].length),c.i64.gt(d[43],c.i64.cast([0,0]))?c.loopAsync(d[43],function(e){return d[44]=e,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[37],d[44]).then(function(a){return a=a,d[45]=a[0],d[46]=a[1],a})},function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[36],d[42]).then(function(a){return a=a,d[47]=a[0],d[48]=a[1],a})},function(e){return c.storedProcedure(b("LSIssuePointQueryRestoreTask"),a[2],d[47],d[45],void 0,c.i64.cast([0,35])).then(function(a){return a=a,d[49]=a[0],a})},function(a){return d[42]=c.i64.add(d[42],c.i64.cast([0,1]))}])}):c.resolve()},function(a){return d[41]=void 0}]):c.resolve((d[42]=new c.Map(),d[42].set("error_code",c.i64.cast([0,106])),d[42].set("stored_procedure","LSEncryptedBackupsHandleMessageRestoreResponseStoredProcedure"),d[42].set("error_message",""),d[41]=d[42]))},function(a){return d[38]=void 0}]):c.resolve((d[39]=new c.Map(),d[39].set("error_code",c.i64.cast([0,105])),d[39].set("stored_procedure","LSEncryptedBackupsHandleMessageRestoreResponseStoredProcedure"),d[39].set("error_message",""),d[38]=d[39]))},function(a){return d[28]=d[38]}])},function(a){return d[26]=d[28]}]):c.resolve(d[26]=d[25])},function(a){return d[23]=d[26]}]):c.resolve((d[22]!==void 0?(d[24]=d[22].get("error_code"),c.i64.eq(d[24],c.i64.cast([0,1]))?0:0):0,d[23]=d[22]))},function(a){return d[15]=d[23]}])},function(e){return d[15]!==void 0?c.sequence([function(e){return c.storedProcedure(b("LSLoadThreadPkFromThreadId"),a[2]).then(function(a){return a=a,d[20]=a[0],d[21]=a[1],a})},function(e){return d[22]=c.i64.of_int32(a[0].length),d[12]!==void 0?c.nativeOperation(b("LSLogWebQpl.nop"),d[12],c.i64.cast([0,521476165]),"decryption_fail",d[22],d[13],!1):c.resolve()},function(e){return a[7]?c.storedProcedure(b("LSDeleteBackupOnClient"),void 0,void 0,!0,d[12],void 0,!0):c.resolve()},function(b){return d[23]=d[15].get("error_code"),d[24]=d[15].get("stored_procedure"),d[25]=a[5].get("restore_operation_type"),d[26]=d[15].get("error_message"),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[43]=new c.Map(),d[43].set("error_msg","Expected a nonempty query result"),d[43].set("code",c.i64.cast([0,3])),d[43].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),d[44]=c.createArray(),d[45]=(d[44].push(d[43]),d[44]),e=[void 0,d[44]],d[27]=e[0],d[28]=e[1]):(b=a.item,d[43]=new c.Map(),d[43].set("backup_id",b.backupId),d[43].set("device_public_key_blob",b.devicePublicKeyBlob),d[43].set("device_private_key_blob",b.devicePrivateKeyBlob),d[43].set("epoch_storage_public_key_blob",b.epochStoragePublicKeyBlob),d[43].set("epoch_storage_private_key_blob",b.epochStoragePrivateKeyBlob),d[43].set("epoch_auth_public_key_blob",b.epochAuthPublicKeyBlob),d[43].set("epoch_auth_private_key_blob",b.epochAuthPrivateKeyBlob),d[43].set("mailbox_root_key_blob",b.mailboxRootKeyBlob),d[43].set("ocmf_client_state_blob",b.ocmfClientStateBlob),d[43].set("orf_client_state_v2_blob",void 0),d[43].set("orf_v2_authority_level",void 0),d[43].set("oblivious_validation_token_blob",b.obliviousValidationTokenBlob),d[43].set("device_id",b.deviceId),d[43].set("backup_tenancy",b.backupTenancy),d[43].set("encryption_version",b.encryptionVersion),d[43].set("revision_version",b.revisionVersion),d[43].set("initialize_restore_result",void 0),d[43].set("device_creation_timestamp_sec",void 0),d[43].set("authority_level",b.authorityLevel),e=[d[43],void 0],d[27]=e[0],d[28]=e[1])})},function(a){return d[30]=new c.Map(),d[30].set("value",d[27]),d[30].set("errors",d[28]),d[31]=d[30].get("value"),d[31]!==void 0?c.sequence([function(a){return d[43]=d[31].get("backup_id"),d[44]=d[31].get("device_public_key_blob"),d[45]=d[31].get("device_private_key_blob"),d[46]=d[31].get("epoch_storage_public_key_blob"),d[47]=d[31].get("epoch_storage_private_key_blob"),d[48]=d[31].get("epoch_auth_public_key_blob"),d[49]=d[31].get("epoch_auth_private_key_blob"),d[50]=d[31].get("mailbox_root_key_blob"),d[51]=d[31].get("ocmf_client_state_blob"),d[52]=d[31].get("orf_client_state_v2_blob"),d[53]=d[31].get("orf_v2_authority_level"),d[54]=d[31].get("oblivious_validation_token_blob"),d[55]=d[31].get("device_id"),d[56]=d[31].get("backup_tenancy"),d[57]=d[31].get("encryption_version"),d[58]=d[31].get("revision_version"),d[59]=d[31].get("initialize_restore_result"),d[60]=d[31].get("device_creation_timestamp_sec"),d[61]=d[31].get("authority_level"),c.i64.neq(d[55],void 0)?c.sequence([function(a){return d[63]=void 0,c.i64.neq(d[63],void 0)?c.resolve(d[64]=d[63]):c.sequence([function(a){return d[67]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[68]=a[0],a})},function(a){return d[68]?d[77]=(d[67].push(c.i64.cast([0,0])),d[67]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[69]=a[0],a})},function(a){return d[69]?d[77]=(d[67].push(c.i64.cast([0,2])),d[67]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[70]=a[0],a})},function(a){return d[70]?d[77]=(d[67].push(c.i64.cast([0,3])),d[67]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[71]=a[0],a})},function(a){return d[71]?d[77]=(d[67].push(c.i64.cast([0,4])),d[67]):0,d[72]=c.createArray(),d[73]=c.i64.of_int32(d[67].length),c.i64.gt(d[73],c.i64.cast([0,0]))?c.loopAsync(d[73],function(a){return d[77]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[67],d[77]).then(function(a){return a=a,d[78]=a[0],d[79]=a[1],a})},function(a){return d[80]=(d[72].push(d[78]),d[72])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[77]=c.createArray(),d[78]=c.i64.of_int32(d[72].length),c.i64.gt(d[78],c.i64.cast([0,0]))?c.loopAsync(d[78],function(a){return d[80]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[72],d[80]).then(function(a){return a=a,d[81]=a[0],d[82]=a[1],a})},function(a){return d[83]=(d[77].push(c.i64.to_string(d[81])),d[77])}])}):c.resolve()},function(a){return d[79]=d[77].join(","),d[74]=d[79]}])},function(a){return d[72].some(function(a){return c.i64.eq(d[57],a)})?d[75]=d[57]:d[75]=void 0,c.i64.neq(d[75],void 0)?d[76]=d[75]:d[76]=void 0,d[64]=d[76]}])},function(a){return c.i64.neq(d[64],void 0)?d[65]=d[64]:d[65]=c.i64.cast([0,0]),c.i64.neq(d[56],void 0)?d[66]=d[56]:d[66]=c.i64.cast([0,1]),d[62]=d[55]}]):c.resolve(d[62]=void 0)},function(a){return d[32]=d[62]}]):c.resolve((d[43]=d[30].get("errors"),d[44]=d[30].get("errors"),d[32]=void 0))},function(e){return d[33]=new c.Map(),d[33].set("error_code",d[23]),d[33].set("error_message",d[26]==null?"":d[26]),d[33].set("stored_procedure",d[24]),d[34]=new c.Map(),d[34].set("act_thread_id",a[2]),d[34].set("source",d[13]),d[34].set("restore_operation_type",d[25]),d[34].set("request_id",d[12]),d[34].set("device_id",d[32]),d[35]=new c.Map(),d[35].set("restore_context",d[34]),d[35].set("failure",d[33]),d[36]=d[35].get("queue_name"),d[36]!==void 0?d[37]=d[36]:(d[43]=d[35].get("restore_context"),d[44]=d[43].get("act_thread_id"),d[37]=["encrypted_backups_restore",":",d[44]].join("")),d[38]=c.toJSON(d[35]),c.storedProcedure(b("LSIssueNewTask"),d[37],c.i64.cast([0,50030]),d[38],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(b){return d[39]=a[5].get("restore_operation_type"),d[40]=d[15].get("error_code"),d[41]=d[15].get("error_code"),d[42]=" ",d[16]=["Failed (",d[42],c.i64.to_string(d[41]),d[42],")"].join("")}]):c.sequence([function(e){return c.storedProcedure(b("LSLoadThreadPkFromThreadId"),a[2]).then(function(a){return a=a,d[20]=a[0],d[21]=a[1],a})},function(b){return d[22]=a[5].get("restore_operation_type"),d[16]="Succeeded"}])},function(e){return d[17]="",d[18]=["Message Restore Status: ",d[17],d[16],d[17],". ACT Thread ID: ",d[17],a[2]].join(""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][handleMessageRestoreResponse] ","",d[18]].join("")),d[19]=c.createArray(),void 0!==void 0?d[20]=(d[19].push(void 0),d[19]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"handleMessageRestoreResponse",[d[18]].join(""),d[19],c.i64.cast([0,4]))}])},function(a){return d[5]=c.i64.of_float(Date.now()),d[6]=c.i64.random(),d[8]="Finishing execution. Execution time: ",d[9]=c.i64.to_string(c.i64.sub(d[5],d[0])),d[10]=" ms",d[7]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][handleMessageRestoreResponse] ",d[7],d[8],d[7],d[9],d[7],d[10]].join("")),c.i64.eq(c.i64.mod_(d[6],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[11]=",",d[12]=c.createArray(),void 0!==void 0?d[13]=(d[12].push(void 0),d[12]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"handleMessageRestoreResponse",[d[8],d[11],d[9],d[11],d[10]].join(""),d[12],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsHandleMessageRestoreResponseStoredProcedure";a.__tables__=["secure_encrypted_backups_client_state"];e.exports=a}),null);