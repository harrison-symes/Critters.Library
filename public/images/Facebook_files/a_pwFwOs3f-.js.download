;/*FB_PKG_DELIM*/

__d("FBNucleusWatchTvFilled12Icon.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){return i.jsxs("svg",babelHelpers["extends"]({viewBox:"0 0 12 12",width:"1em",height:"1em",fill:"currentColor"},a,{children:[a.title!=null&&i.jsx("title",{children:a.title}),a.children!=null&&i.jsx("defs",{children:a.children}),i.jsx("path",{d:"M7.287 1c.911 0 1.646 0 2.224.078.6.08 1.106.253 1.507.654.401.402.574.907.654 1.507.078.578.078 1.313.078 2.224v.074c0 .911 0 1.646-.078 2.224-.08.6-.253 1.105-.654 1.507-.402.401-.907.574-1.507.654C8.933 10 8.198 10 7.287 10H4.713c-.911 0-1.646 0-2.224-.078-.6-.08-1.105-.253-1.507-.654C.581 8.866.408 8.36.328 7.76.25 7.183.25 6.448.25 5.537v-.074c0-.911 0-1.646.078-2.224.08-.6.253-1.105.654-1.507.402-.401.907-.574 1.507-.654C3.067 1 3.802 1 4.713 1h2.574zM5.498 4.066a.5.5 0 0 0-.748.434v2a.5.5 0 0 0 .748.434l1.75-1a.5.5 0 0 0 0-.868l-1.75-1zM3.5 11.25a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1H4a.5.5 0 0 1-.5-.5z"})]}))}a.displayName=a.name+" [from "+f.id+"]";a._size=12;a._isSVG=!0;b=a;g["default"]=b}),98);
__d("LSIssuePointQueryRestoreTask",["LSArrayGetObjectAt","LSBase64Encode.nop","LSIsEncryptionVersionSecure","LSIssueNewTaskAndGetTaskID","LSLogMebClientEvent.nop","LSLogWebQpl.nop","LSQplAnnotateString.nop","LSQplMarkPoint.nop","LSQplStartTrace.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][issuePointQueryRestoreTask] Beginning execution."),d[1]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsIssuePointQueryRestoreTaskStoredProcedure] Point query restore v2 is enabled"),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[14]=new c.Map(),d[14].set("error_msg","Expected a nonempty query result"),d[14].set("code",c.i64.cast([0,3])),d[14].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),d[15]=c.createArray(),d[16]=(d[15].push(d[14]),d[15]),e=[void 0,d[15]],d[2]=e[0],d[3]=e[1]):(b=a.item,d[14]=new c.Map(),d[14].set("backup_id",b.backupId),d[14].set("device_public_key_blob",b.devicePublicKeyBlob),d[14].set("device_private_key_blob",b.devicePrivateKeyBlob),d[14].set("epoch_storage_public_key_blob",b.epochStoragePublicKeyBlob),d[14].set("epoch_storage_private_key_blob",b.epochStoragePrivateKeyBlob),d[14].set("epoch_auth_public_key_blob",b.epochAuthPublicKeyBlob),d[14].set("epoch_auth_private_key_blob",b.epochAuthPrivateKeyBlob),d[14].set("mailbox_root_key_blob",b.mailboxRootKeyBlob),d[14].set("ocmf_client_state_blob",b.ocmfClientStateBlob),d[14].set("orf_client_state_v2_blob",void 0),d[14].set("orf_v2_authority_level",void 0),d[14].set("oblivious_validation_token_blob",b.obliviousValidationTokenBlob),d[14].set("device_id",b.deviceId),d[14].set("backup_tenancy",b.backupTenancy),d[14].set("encryption_version",b.encryptionVersion),d[14].set("revision_version",b.revisionVersion),d[14].set("initialize_restore_result",void 0),d[14].set("device_creation_timestamp_sec",void 0),d[14].set("authority_level",b.authorityLevel),e=[d[14],void 0],d[2]=e[0],d[3]=e[1])})},function(e){return d[5]=new c.Map(),d[5].set("value",d[2]),d[5].set("errors",d[3]),d[6]=d[5].get("value"),d[6]!==void 0?c.sequence([function(e){return d[14]=d[6].get("backup_id"),d[15]=d[6].get("device_public_key_blob"),d[16]=d[6].get("device_private_key_blob"),d[17]=d[6].get("epoch_storage_public_key_blob"),d[18]=d[6].get("epoch_storage_private_key_blob"),d[19]=d[6].get("epoch_auth_public_key_blob"),d[20]=d[6].get("epoch_auth_private_key_blob"),d[21]=d[6].get("mailbox_root_key_blob"),d[22]=d[6].get("ocmf_client_state_blob"),d[23]=d[6].get("orf_client_state_v2_blob"),d[24]=d[6].get("orf_v2_authority_level"),d[25]=d[6].get("oblivious_validation_token_blob"),d[26]=d[6].get("device_id"),d[27]=d[6].get("backup_tenancy"),d[28]=d[6].get("encryption_version"),d[29]=d[6].get("revision_version"),d[30]=d[6].get("initialize_restore_result"),d[31]=d[6].get("device_creation_timestamp_sec"),d[32]=d[6].get("authority_level"),c.i64.neq(d[26],void 0)?c.sequence([function(a){return d[34]=void 0,c.i64.neq(d[34],void 0)?c.resolve(d[35]=d[34]):c.sequence([function(a){return d[61]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[62]=a[0],a})},function(a){return d[62]?d[71]=(d[61].push(c.i64.cast([0,0])),d[61]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[63]=a[0],a})},function(a){return d[63]?d[71]=(d[61].push(c.i64.cast([0,2])),d[61]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[64]=a[0],a})},function(a){return d[64]?d[71]=(d[61].push(c.i64.cast([0,3])),d[61]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[65]=a[0],a})},function(a){return d[65]?d[71]=(d[61].push(c.i64.cast([0,4])),d[61]):0,d[66]=c.createArray(),d[67]=c.i64.of_int32(d[61].length),c.i64.gt(d[67],c.i64.cast([0,0]))?c.loopAsync(d[67],function(a){return d[71]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[61],d[71]).then(function(a){return a=a,d[72]=a[0],d[73]=a[1],a})},function(a){return d[74]=(d[66].push(d[72]),d[66])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[71]=c.createArray(),d[72]=c.i64.of_int32(d[66].length),c.i64.gt(d[72],c.i64.cast([0,0]))?c.loopAsync(d[72],function(a){return d[74]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[66],d[74]).then(function(a){return a=a,d[75]=a[0],d[76]=a[1],a})},function(a){return d[77]=(d[71].push(c.i64.to_string(d[75])),d[71])}])}):c.resolve()},function(a){return d[73]=d[71].join(","),d[68]=d[73]}])},function(a){return d[66].some(function(a){return c.i64.eq(d[28],a)})?d[69]=d[28]:d[69]=void 0,c.i64.neq(d[69],void 0)?d[70]=d[69]:d[70]=void 0,d[35]=d[70]}])},function(e){return c.i64.neq(d[35],void 0)?d[36]=d[35]:d[36]=c.i64.cast([0,0]),c.i64.neq(d[27],void 0)?d[37]=d[27]:d[37]=c.i64.cast([0,1]),d[38]=c.i64.random(),d[39]=a[3]==null?c.i64.to_string(d[38]):a[3],d[39]!==void 0?c.nativeOperation(b("LSQplStartTrace.nop"),c.i64.cast([0,679677570]),d[39],!0,void 0):c.resolve()},function(a){return d[39]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679677570]),d[39],"issue_task"):c.resolve()},function(a){return d[39]!==void 0?c.nativeOperation(b("LSQplAnnotateString.nop"),c.i64.cast([0,679677570]),d[39],"request_type","ENCRYPTED_BACKUPS_MESSAGE_POINT_QUERY"):c.resolve()},function(e){return d[58]=c.i64.to_string(a[4]),d[39]!==void 0?d[58]!==void 0?c.nativeOperation(b("LSQplAnnotateString.nop"),c.i64.cast([0,679677570]),d[39],"task_creation_source",d[58]):c.resolve():c.resolve()},function(e){return d[40]=new c.Map(),d[40].set("act_thread_id",a[0]),d[40].set("request_id",d[39]),d[40].set("tam_thread_subtype",c.i64.cast([0,0])),d[40].set("mem_message_type",c.i64.cast([0,0])),d[40].set("source",a[4]),c.nativeOperation(b("LSBase64Encode.nop"),d[22]).then(function(a){return a=a,d[41]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[21]).then(function(a){return a=a,d[42]=a[0],a})},function(a){return d[43]=new c.Map(),d[43].set("ocmf_client_state_blob",d[41]==null?"":d[41]),d[43].set("mailbox_root_key",d[42]==null?"":d[42]),d[44]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[61]=(d[44].push(a.epochId),d[44])})},function(a){return d[59]="Queried locally available epochs. Count: ",d[45]=c.i64.of_int32(d[44].length),d[60]=c.i64.to_string(d[45]),d[46]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBEpochClientUtils] ",d[46],d[59],d[46],d[60]].join("")),c.resolve()},function(e){return d[47]=new c.Map(),d[47].set("device_id",d[26]),d[47].set("raw_tokens",d[43]),d[47].set("locally_available_epochs",d[44]),d[48]=new c.Map(),d[48].set("reference_timestamp",a[2]),d[48].set("device_context",d[47]),d[48].set("message_id",a[1]),d[49]=new c.Map(),d[49].set("restore_context",d[40]),d[49].set("success",d[48]),c.i64.gt(c.i64.cast([0,0]),c.i64.cast([0,0]))?(d[61]=c.i64.of_float(Date.now()),d[50]=c.i64.add(d[61],c.i64.cast([0,0]))):d[50]=c.i64.cast([0,0]),d[51]=d[49].get("restore_context"),d[52]=d[49].get("success"),d[52]!==void 0?(d[61]=d[52].get("message_id"),d[53]=d[61]):d[53]="",d[54]=d[51].get("act_thread_id"),d[55]=":",d[56]=c.toJSON(d[49]),c.storedProcedure(b("LSIssueNewTaskAndGetTaskID"),["encrypted_backups_restore",d[55],d[54],d[55],d[53]].join(""),c.i64.cast([0,50035]),d[56],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,d[50],c.i64.cast([0,0])).then(function(a){return a=a,d[57]=a[0],a})},function(a){return d[33]=d[57]}]):c.sequence([function(e){return d[34]=new c.Map(),d[34].set("error_code",c.i64.cast([0,1])),d[34].set("error_message",""),d[34].set("stored_procedure","issuePointQueryRestoreTask"),d[35]=new c.Map(),d[35].set("act_thread_id",a[0]),d[36]=new c.Map(),d[36].set("restore_context",d[35]),d[36].set("failure",d[34]),c.i64.gt(c.i64.cast([0,0]),c.i64.cast([0,0]))?(d[45]=c.i64.of_float(Date.now()),d[37]=c.i64.add(d[45],c.i64.cast([0,0]))):d[37]=c.i64.cast([0,0]),d[38]=d[36].get("restore_context"),d[39]=d[36].get("success"),d[39]!==void 0?(d[45]=d[39].get("message_id"),d[40]=d[45]):d[40]="",d[41]=d[38].get("act_thread_id"),d[42]=":",d[43]=c.toJSON(d[36]),c.storedProcedure(b("LSIssueNewTaskAndGetTaskID"),["encrypted_backups_restore",d[42],d[41],d[42],d[40]].join(""),c.i64.cast([0,50035]),d[43],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,d[37],c.i64.cast([0,0])).then(function(a){return a=a,d[44]=a[0],a})},function(a){return d[33]=d[44]}])},function(a){return d[7]=d[33]}]):c.sequence([function(e){return d[14]=d[5].get("errors"),d[15]=d[5].get("errors"),d[16]=new c.Map(),d[16].set("error_code",c.i64.cast([0,1])),d[16].set("error_message",""),d[16].set("stored_procedure","issuePointQueryRestoreTask"),d[17]=new c.Map(),d[17].set("act_thread_id",a[0]),d[18]=new c.Map(),d[18].set("restore_context",d[17]),d[18].set("failure",d[16]),c.i64.gt(c.i64.cast([0,0]),c.i64.cast([0,0]))?(d[27]=c.i64.of_float(Date.now()),d[19]=c.i64.add(d[27],c.i64.cast([0,0]))):d[19]=c.i64.cast([0,0]),d[20]=d[18].get("restore_context"),d[21]=d[18].get("success"),d[21]!==void 0?(d[27]=d[21].get("message_id"),d[22]=d[27]):d[22]="",d[23]=d[20].get("act_thread_id"),d[24]=":",d[25]=c.toJSON(d[18]),c.storedProcedure(b("LSIssueNewTaskAndGetTaskID"),["encrypted_backups_restore",d[24],d[23],d[24],d[22]].join(""),c.i64.cast([0,50035]),d[25],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,d[19],c.i64.cast([0,0])).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[7]=d[26]}])},function(d){return a[3]!==void 0?c.nativeOperation(b("LSLogWebQpl.nop"),a[3],c.i64.cast([0,521476165]),"restore_task_start",c.i64.cast([0,1]),a[4],void 0):c.resolve()},function(a){return d[8]=c.i64.of_float(Date.now()),d[9]=c.i64.random(),d[11]="Finishing execution. Execution time: ",d[12]=c.i64.to_string(c.i64.sub(d[8],d[0])),d[13]=" ms",d[10]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][issuePointQueryRestoreTask] ",d[10],d[11],d[10],d[12],d[10],d[13]].join("")),c.i64.eq(c.i64.mod_(d[9],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[14]=",",d[15]=c.createArray(),void 0!==void 0?d[16]=(d[15].push(void 0),d[15]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"issuePointQueryRestoreTask",[d[11],d[14],d[12],d[14],d[13]].join(""),d[15],c.i64.cast([0,4]))):c.resolve()},function(a){return e[0]=d[7]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsIssuePointQueryRestoreTaskStoredProcedure";a.__tables__=["secure_encrypted_backups_client_state","secure_encrypted_backups_epochs"];e.exports=a}),null);